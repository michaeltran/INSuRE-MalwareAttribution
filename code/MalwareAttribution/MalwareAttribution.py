import argparse
import pandas as pd
import time
from sklearn.model_selection import cross_val_score
from sklearn.metrics import classification_report, confusion_matrix, accuracy_score

from Classifier.Classifier import Classifier, Feature

clf = Classifier()

def main():
    string = '__exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ NtAllocateVirtualMemory NtAllocateVirtualMemory LdrLoadDll LdrLoadDll LdrLoadDll __exception__ __exception__ __exception__ __exception__ NtCreateFile NtCreateFile NtCreateFile __exception__ RegOpenKeyExA RegOpenKeyExA LdrGetProcedureAddress GetNativeSystemInfo __exception__ __exception__ __exception__ GetSystemInfo LdrLoadDll LdrGetProcedureAddress timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime __exception__ __exception__ __exception__ timeGetTime NtDelayExecution timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime timeGetTime GetSystemDirectoryA NtClose NtClose NtClose __exception__ __exception__ NtClose __exception__ __exception__ __exception__ OutputDebugStringA __exception__ __exception__ NtAllocateVirtualMemory LdrLoadDll LdrGetProcedureAddress LdrLoadDll LdrGetProcedureAddress timeGetTime timeGetTime __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ GetForegroundWindow __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ RegOpenKeyExA RegQueryValueExA RegCloseKey RegOpenKeyExA RegQueryValueExA RegQueryValueExA RegCloseKey NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtClose NtOpenKey NtQueryValueKey NtClose NtOpenKey NtQueryValueKey NtClose LdrLoadDll LdrGetProcedureAddress LdrGetProcedureAddress GetSystemWindowsDirectoryW NtCreateFile NtCreateSection NtMapViewOfSection NtClose NtClose NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory FindWindowA FindWindowA FindWindowA CreateToolhelp32Snapshot Process32FirstW Process32NextW NtClose GetSystemDirectoryA NtCreateFile SetFilePointer NtReadFile NtClose __exception__ __exception__ __exception__ IsDebuggerPresent __exception__ __exception__ __exception__ FindWindowA FindWindowA FindWindowA FindWindowA NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory LdrGetDllHandle LdrGetDllHandle __exception__ __exception__ NtAllocateVirtualMemory NtFreeVirtualMemory FindWindowA FindWindowA FindWindowA NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory __exception__ __exception__ __exception__ LdrGetDllHandle LdrGetDllHandle LdrGetDllHandle LdrGetDllHandle NtProtectVirtualMemory NtProtectVirtualMemory NtProtectVirtualMemory __exception__ __exception__ __exception__ LdrGetProcedureAddress NtAllocateVirtualMemory LdrLoadDll LdrLoadDll LdrLoadDll RegOpenKeyExW RegQueryValueExW RegCloseKey RegOpenKeyExW RegQueryValueExW RegCloseKey GetSystemInfo LdrGetDllHandle LdrGetProcedureAddress RegOpenKeyExW GetSystemDirectoryW RegOpenKeyExA RegOpenKeyExA LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll LdrLoadDll __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ NtCreateFile NtCreateSection NtMapViewOfSection GetSystemInfo NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory LdrLoadDll LdrGetProcedureAddress LdrUnloadDll NtUnmapViewOfSection NtClose NtClose __exception__ __exception__ NtAllocateVirtualMemory NtAllocateVirtualMemory NtProtectVirtualMemory __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ NtProtectVirtualMemory __exception__ __exception__ __exception__ __exception__ __exception__ FindWindowA FindWindowA FindWindowA FindWindowA NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetProcedureAddress NtQuerySystemInformation NtFreeVirtualMemory __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ NtAllocateVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ __exception__ NtProtectVirtualMemory NtProtectVirtualMemory __exception__ __exception__ __exception__ NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle NtAllocateVirtualMemory LdrGetDllHandle LdrGetDllHandle LdrGetDllHandle NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetDllHandle NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory LdrGetDllHandle LdrGetDllHandle NtAllocateVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtAllocateVirtualMemory NtFreeVirtualMemory NtFreeVirtualMemory NtFreeVirtualMemory NtFreeVirtualMemory NtFreeVirtualMemory NtFreeVirtualMemory __exception__ __exception__ __exception__ NtProtectVirtualMemory NtProtectVirtualMemory LdrGetProcedureAddress NtProtectVirtualMemory NtProtectVirtualMemory RegOpenKeyExA RegOpenKeyExA RegOpenKeyExA NtQueryAttributesFile NtQueryAttributesFile NtQueryAttributesFile NtQueryAttributesFile LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA NtAllocateVirtualMemory NtAllocateVirtualMemory LoadStringA LoadStringA LdrGetDllHandle LdrGetProcedureAddress LdrGetDllHandle LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetDllHandle LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LoadStringA LdrGetProcedureAddress LdrGetProcedureAddress GetSystemMetrics GetSystemMetrics FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource FindResourceExW LoadResource LdrGetProcedureAddress FindResourceExW FindResourceExW NtAllocateVirtualMemory GetSystemMetrics GetSystemMetrics NtClose NtClose GetSystemMetrics NtAllocateVirtualMemory GetSystemMetrics GetSystemMetrics LdrLoadDll LdrGetProcedureAddress LdrGetDllHandle FindResourceExW FindResourceExW DrawTextExW GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics DrawTextExW LdrGetDllHandle FindResourceExW FindResourceExW FindResourceExW LoadResource LdrGetDllHandle LdrGetProcedureAddress LdrGetDllHandle LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetDllHandle LdrGetProcedureAddress NtOpenMutant NtCreateMutant GetSystemMetrics GetSystemMetrics FindResourceA FindResourceA LoadResource SizeofResource GetSystemMetrics NtAllocateVirtualMemory CreateActCtxW GetSystemWindowsDirectoryW CreateActCtxW LdrGetDllHandle LdrGetProcedureAddress LdrLoadDll LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrGetProcedureAddress LdrLoadDll LdrGetProcedureAddress DrawTextExW GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics DrawTextExW GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSystemMetrics GetSy'
    test = string.split(' ')
    #print(test)

    start = time.time()

    ## Get Command-line Arguments #################
    parser = argparse.ArgumentParser()
    parser.add_argument('-d', '--data', default='../../data', help='')
    opts = parser.parse_args()
    ###############################################

    dynamic_training_data_dict = LoadDataDynamic(opts.data, 'dynamic_train_data.csv')
    dynamic_testing_data_dict = LoadDataDynamic(opts.data, 'dynamic_test_data.csv')

    static_training_data_dict = LoadDataStatic(opts.data, 'static_train_data.csv')
    static_testing_data_dict = LoadDataStatic(opts.data, 'static_test_data.csv')

    # DYNAMIC
    nb_clf = clf.BuildClassifierNB(dynamic_training_data_dict, dynamic_training_data_dict['classification'], 
        [Feature.TRID, Feature.PE_RESOURCE_LIST],
        #[Feature.NETWORK_UDP_SRC, Feature.NETWORK_UDP_DST],
        #[Feature.BEHAVIOR_CALLS, Feature.NETWORK_UDP_SRC, Feature.NETWORK_UDP_DST]
    )
    nb_predictions = nb_clf.predict(dynamic_testing_data_dict)
    print("NB Accuracy: %0.2f" % (accuracy_score(dynamic_testing_data_dict['classification'], nb_predictions)))

    # STATIC
    #nb_clf = clf.BuildClassifierNB(static_training_data_dict, static_training_data_dict['classification'], [Feature.IMPORTS_LIST])
    nb_clf = clf.BuildClassifierNB(static_training_data_dict, static_training_data_dict['classification'], 
        [Feature.TRID, Feature.PE_RESOURCE_LIST],
        #[Feature.EMBEDDED_DOMAINS_LIST, Feature.TRID, Feature.PE_RESOURCE_LIST, Feature.IMPORTS_LIST, Feature.CONTACTED_URLS_LIST]
    )
    nb_predictions = nb_clf.predict(static_testing_data_dict)
    print("NB Accuracy: %0.2f" % (accuracy_score(static_testing_data_dict['classification'], nb_predictions)))

    end = time.time()
    print("Time Run = %fs" % (end - start))

def FeatureTesting():
    nb_clf = clf.BuildClassifierNB(training_data_dict, training_data_dict['classification'], [Feature.TRID, Feature.PE_RESOURCE_LIST])
    nb_predictions = nb_clf.predict(testing_data_dict)
    print("NB Accuracy: %0.2f" % (accuracy_score(testing_data_dict['classification'], nb_predictions)))

    #feats = nb_clf.named_steps['features']
    #X = feats.transform(training_data_dict)
    #Y = feats.transform(testing_data_dict)
    #print(X)
    #print(Y)

    return

def LoadDataStatic(data_folder_path, file_name):
    data_dict = {}
    data_dict['classification'] = []
    data_dict['embedded_domains_list'] = []
    data_dict['trid'] = []
    data_dict['pe_resource_list'] = []
    data_dict['imports_list'] = []
    data_dict['contacted_urls_list'] = []

    df = pd.read_csv(data_folder_path + '/' + file_name)
    for i in range(len(df['hash'])):
        embedded_domains_list = df['embedded_domains_list'][i]
        if embedded_domains_list != embedded_domains_list:
            embedded_domains_list = ''
        pe_resource_list = df['pe_resource_list'][i]
        if pe_resource_list != pe_resource_list:
            pe_resource_list = ''
        imports_list = df['imports_list'][i]
        if imports_list != imports_list:
            imports_list = ''
        contacted_urls_list = df['contacted_urls_list'][i]
        if contacted_urls_list != contacted_urls_list:
            contacted_urls_list = ''

        data_dict['classification'].append(df['classification'][i])
        data_dict['embedded_domains_list'].append(embedded_domains_list)
        data_dict['trid'].append(df['trid'][i])
        data_dict['pe_resource_list'].append(pe_resource_list)
        data_dict['imports_list'].append(imports_list)
        data_dict['contacted_urls_list'].append(contacted_urls_list)

    return data_dict

def LoadDataDynamic(data_folder_path, file_name):
    data_dict = {}
    data_dict['classification'] = []

    data_dict['behavior_calls'] = []
    data_dict['network_udp_src'] = []
    data_dict['network_udp_dst'] = []

    data_dict['embedded_domains_list'] = []
    data_dict['trid'] = []
    data_dict['pe_resource_list'] = []
    data_dict['imports_list'] = []
    data_dict['contacted_urls_list'] = []

    df = pd.read_csv(data_folder_path + '/' + file_name)
    for i in range(len(df['hash'])):
        behavior_calls = df['behavior_calls'][i]
        if behavior_calls != behavior_calls:
            behavior_calls = ''
        network_udp_src = df['network_udp_src'][i]
        if network_udp_src != network_udp_src:
            network_udp_src = ''
        network_udp_dst = df['network_udp_dst'][i]
        if network_udp_dst != network_udp_dst:
            network_udp_dst = ''

        embedded_domains_list = df['embedded_domains_list'][i]
        if embedded_domains_list != embedded_domains_list:
            embedded_domains_list = ''
        pe_resource_list = df['pe_resource_list'][i]
        if pe_resource_list != pe_resource_list:
            pe_resource_list = ''
        imports_list = df['imports_list'][i]
        if imports_list != imports_list:
            imports_list = ''
        contacted_urls_list = df['contacted_urls_list'][i]
        if contacted_urls_list != contacted_urls_list:
            contacted_urls_list = ''

        data_dict['classification'].append(df['classification'][i])

        data_dict['behavior_calls'].append(behavior_calls)
        data_dict['network_udp_src'].append(network_udp_src)
        data_dict['network_udp_dst'].append(network_udp_dst)

        data_dict['embedded_domains_list'].append(embedded_domains_list)
        data_dict['trid'].append(df['trid'][i])
        data_dict['pe_resource_list'].append(pe_resource_list)
        data_dict['imports_list'].append(imports_list)
        data_dict['contacted_urls_list'].append(contacted_urls_list)

    return data_dict

if __name__ == '__main__':
    main()